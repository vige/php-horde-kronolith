From: Michael J Rubinsky <mrubinsk@horde.org>
Date: Tue, 25 Sep 2018 12:15:27 -0400
Subject: [PATCH] Bug: 14857

Prevent XSS in event's URL field.
---
 kronolith-4.2.24/lib/Event.php | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/kronolith-4.2.24/lib/Event.php b/kronolith-4.2.24/lib/Event.php
index 74e0169d..462f90b2 100644
--- a/kronolith-4.2.24/lib/Event.php
+++ b/kronolith-4.2.24/lib/Event.php
@@ -2402,8 +2402,8 @@ public function toJson($allDay = null, $full = false, $time_format = 'H:i')
             }
             if (!$this->isPrivate()) {
                 $json->d = $this->description;
-                $json->u = $this->url;
-                $json->uhl = $GLOBALS['injector']->getInstance('Horde_Core_Factory_TextFilter')->filter($this->url, 'linkurls');
+                $json->u =  htmlentities($this->url);
+                $json->uhl = htmlentities($GLOBALS['injector']->getInstance('Horde_Core_Factory_TextFilter')->filter($this->url, 'linkurls'));
                 $json->tg = array_values($this->tags);
                 $json->gl = $this->geoLocation;
                 if ($this->attendees) {
